<!DOCTYPE html>
<html lang="zh-TW">

<head>
	<meta charset="UTF-8">
	<title> </title>
</head>

<body>
<div style="background-color:skyblue; display: flex; align-items: center; gap: 20px; padding: 10px; position: relative; z-index: 100;"> 
        <a href="https://raingod0101.github.io/"><img src="p3.png" width="70" height="70"></a>
        <a href="math.html" style="text-decoration: none; color: black;"><span style="font-size: 40px;">數學</span></a>
        <a href="game.html" style="text-decoration: none; color: black;"><span style="font-size: 40px;">遊戲</span></a>
    </div>

    <div style="margin-left: 80px; margin-top: 20px;">
        <pre>                                        <button onclick="yu()" style="width:40px; height:40px;">↑</button>
                                 <button onclick="xd()" style="width:40px; height:40px;">←</button><button onclick="yd()" style="width:40px; height:40px;">↓</button><button onclick="xu()" style="width:40px; height:40px;">→</button></pre>
        
        <h1 id="di" style="color: red;"></h1>
        <h2 id="say"></h2>
        
        <canvas id="canvas" width="500" height="500" style="background-color: skyblue; border: 2px solid #333;"></canvas>
    </div>
	<script>
		var long = 1
		var canvas = document.getElementById("canvas")
		var ctx = canvas.getContext("2d")	
		var x = 25
		var y = 25
		var px = [];
		var py = [];
		var last = "";
		var appx=Math.floor(Math.random()*50)
		var appy=Math.floor(Math.random()*50)
		function die(){
			document.getElementById("di").innerText = "game over"
			clearInterval(gameInterval)
			document.getElementById("say").innerText = `long:0`
		}
		function sayz(){
			document.getElementById("say").innerText = `long:${long}`
		}
		function yu(){
			y--
			last="w"
		}
		function xu(){
			x++
			last="d"
		}
		function yd(){
			y++
			last="s"
		}
		function xd(){
			x--
			last="a"
		}
		function apple(){
			ctx.fillStyle="red"
			ctx.fillRect(10*appx, 10*appy, 15, 15)
			ctx.fillStyle="lime"
		}
		var gameInterval=setInterval(()=>{
            a(last)
			sayz()
        }, 100)
		function a(d) {
			if(long<1){
				die()
			}
			if (d==='w'&&y>0) {
				y--
			}
			if (d==='s'&&y<49) {
				y++
			}
			if (d==='a'&&x>0) {
				x--
			}
			if (d==='d'&&x<49) {
				x++
			}
            if (d==='w'&&y<1) {
				last="s"
				long-=1
			}
			if (d==='s'&&y===49) {
				last="w"
				long-=1
			}
			if (d==='a'&&x<1) {
				last="d"
				long-=1
			}
			if (d==='d'&& x === 49) {
				last="a"
				long-=1
			}

			px.unshift(x);
			py.unshift(y);


			ctx.clearRect(0, 0, 2000, 2000)
			apple()
			for (var i = 0; i < long; i++) {
				if(i===0){
					ctx.fillStyle="blue"
					ctx.fillRect(10*px[i]-2,10*py[i]-2, 14, 14)
					ctx.fillStyle="lime"
					if(Math.sqrt((px[i]-appx)*(px[i]-appx)+(py[i]-appy)*(py[i]-appy))<2){
						appx=Math.floor(Math.random()*50)
						appy=Math.floor(Math.random()*50)
						long+=1
					}
				}
				else{
					ctx.fillRect(10 * px[i], 10 * py[i], 10, 10)
				}
				
			}
		}

		var canvas = document.getElementById("canvas")
		var ctx = canvas.getContext("2d")
		document.body.addEventListener('keypress', (an) => {
			if (an.key === 'w' || an.key === 'a' || an.key === 's' || an.key === 'd') last = an.key;
		})
	</script>
</body>

</html>
